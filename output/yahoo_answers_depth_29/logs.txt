Model's parameters: {'optimizer': 'adam', 'input': 'input/yahoo_answers_csv', 'output': 'output/yahoo_answers_depth_29', 'alphabet': 'abcdefghijklmnopqrstuvwxyz0123456789,;.!?:\'"/\\|_@#$%^&*~`+-=<>()[]{}', 'batch_size': 128, 'dataset': 'yahoo_answers', 'depth': 29, 'max_length': 1014, 'lr': 0.001, 'shortcut': False, 'num_epochs': 20, 'gpu': True}Epoch: 1/20 
Training loss: 7.22465290931 Training accuracy: 0.578125 
Test loss: 1.28745926863 Test accuracy: 0.584083333333 
Test confusion matrix: 
[[2518  598  142  483   73  112  106  764  448  756]
 [  90 4942  207  315   79   60   46  137   20  104]
 [ 196 1127 3538  184   38   92   81  267  378   99]
 [ 298 1784  120 2392  182  130  169  377   86  462]
 [  29  414   13  408 4526  125  139  248   32   66]
 [  84  690  131  266   87 3866  114  490   87  185]
 [ 290  793  183  757  488  174 1860  588  280  587]
 [ 363  403   84  308  225  342  100 3587  261  327]
 [ 445  132  176  199   94   99   82  671 3886  216]
 [ 354  459   57  425   77  109  236  290   63 3930]]

Epoch: 2/20 
Training loss: 4.45513406326 Training accuracy: 0.703125 
Test loss: 1.12417240132 Test accuracy: 0.641433333333 
Test confusion matrix: 
[[2869  410  390  428   61  219  128  478  653  364]
 [ 106 4876  370  224   58  129   58   73   26   80]
 [ 112  499 4618  104   17  132   72  123  287   36]
 [ 348 1641  242 2349  153  266  231  262  153  355]
 [  53  439   51  188 4534  187  225  215   68   40]
 [  41  252  128  104   53 4879   70  305   93   75]
 [ 334  659  440  501  370  324 2279  376  398  319]
 [ 302  248  250  211  187  548  124 3652  366  112]
 [ 231   84  497   95   74  126   86  281 4441   85]
 [ 327  336  125  362   44  197  317  183  120 3989]]

Epoch: 3/20 
Training loss: 3.99273742503 Training accuracy: 0.734375 
Test loss: 1.05971174975 Test accuracy: 0.65925 
Test confusion matrix: 
[[3532  221  244  344   96   64  198  245  691  365]
 [ 290 4522  474  235  114   65  120   49   44   87]
 [ 247  223 4625   86   43   64  128   87  444   53]
 [ 671 1279  282 2247  251   85  445  165  149  426]
 [  76  182   36  125 5017   35  328  106   55   40]
 [ 189  179  146  134  108 4547  164  336   99   98]
 [ 608  356  335  342  419  115 2815  277  405  328]
 [ 752  148  169  204  372  227  218 3327  420  163]
 [ 382   39  239   80  103   50  134  191 4696   86]
 [ 565  133   78  182   62   66  452  105  130 4227]]

Epoch: 4/20 
Training loss: 5.3686158724 Training accuracy: 0.765625 
Test loss: 1.02951682278 Test accuracy: 0.671 
Test confusion matrix: 
[[2968  160  347  407   66  129  115  565  788  455]
 [ 158 4304  533  366   87  177   57  172   47   99]
 [ 135  155 4864  100   26   83   55  133  399   50]
 [ 440  970  274 2660  176  237  215  389  183  456]
 [  54  114   45  204 4807  118  210  300   85   63]
 [  42   59  168   58   42 5008   57  396  112   58]
 [ 350  281  423  510  361  299 2284  513  495  484]
 [ 255   99  193  152  196  339   94 4082  477  113]
 [ 207   23  301   73   79   70   77  289 4798   83]
 [ 275   92   99  254   43  148  222  232  150 4485]]

Epoch: 5/20 
Training loss: 4.95575023413 Training accuracy: 0.609375 
Test loss: 1.00058784404 Test accuracy: 0.679316666667 
Test confusion matrix: 
[[3564  105  191  457  107  105  185  297  556  433]
 [ 270 3940  475  641  189  107  138   90   33  117]
 [ 263  143 4531  140   57   90  162  103  439   72]
 [ 502  733  215 2912  272  155  426  205  147  433]
 [  49   45   18  145 5159   67  248  156   65   48]
 [ 106   66   88  109   77 5028  114  241   80   91]
 [ 538  179  248  464  473  178 2813  331  409  367]
 [ 573   68  110  231  270  347  162 3731  330  178]
 [ 449   15  187  104   97   78  112  216 4608  134]
 [ 377   50   49  285   64   97  409  101   95 4473]]

Epoch: 6/20 
Training loss: 5.45622452965 Training accuracy: 0.75 
Test loss: 0.983420222545 Test accuracy: 0.68295 
Test confusion matrix: 
[[3236  370  224  365  100   81  216  570  528  310]
 [ 114 4845  295  174  145   89  108  135   29   66]
 [ 169  433 4554   66   60   67  126  150  330   45]
 [ 411 1392  204 2384  270  128  404  378  105  324]
 [  35  110   20   80 5215   38  258  162   52   30]
 [  51  131  121   63   84 4914  122  385   68   61]
 [ 397  415  273  347  439  127 2846  525  356  275]
 [ 290  188  118  125  297  216  153 4273  233  107]
 [ 317   46  271   68   99   54  146  433 4480   86]
 [ 350  188   57  291   60   87  454  197   86 4230]]

Epoch: 7/20 
Training loss: 5.49623861141 Training accuracy: 0.6875 
Test loss: 1.00422129094 Test accuracy: 0.677016666667 
Test confusion matrix: 
[[2974  245  595  486   79  145  142  504  494  336]
 [ 102 4447  621  278  108  169   78  106   20   71]
 [  91  188 5142   79   30   59   62  110  210   29]
 [ 312 1121  388 2741  214  228  270  295   97  334]
 [  35  114   89  150 5031  101  238  157   49   36]
 [  32   83  211   51   54 5147   68  234   78   42]
 [ 311  338  603  449  402  248 2554  436  326  333]
 [ 228  143  276  174  291  404  118 4025  241  100]
 [ 273   29  629  109   96   76   81  314 4320   73]
 [ 300  141  196  276   52  202  313  171  109 4240]]

Epoch: 8/20 
Training loss: 6.45727238338 Training accuracy: 0.65625 
Test loss: 0.975278068094 Test accuracy: 0.68815 
Test confusion matrix: 
[[3092  211  146  474   76  117  124  789  606  365]
 [ 122 4604  308  310  101  156   89  178   28  104]
 [ 154  312 4366  121   41  132   76  249  494   55]
 [ 336 1083  166 2751  216  223  253  436  135  401]
 [  35  106   13  139 5104   65  184  243   61   50]
 [  42   73   73   60   67 5186   56  321   70   52]
 [ 357  330  241  460  419  229 2497  622  429  416]
 [ 189  110   61  133  233  340   85 4499  243  107]
 [ 244   38  144   95   89   77   68  484 4675   86]
 [ 290  100   47  273   50  140  249  226  110 4515]]

Epoch: 9/20 
Training loss: 4.49817375361 Training accuracy: 0.65625 
Test loss: 0.975405221822 Test accuracy: 0.6859 
Test confusion matrix: 
[[3168  179  182  495  172  115  253  505  479  452]
 [ 120 4390  339  329  312  106  163  117   20  104]
 [ 168  238 4503  122  134  137  170  133  333   62]
 [ 309  981  165 2736  459  137  422  306  101  384]
 [  31   51   13   72 5424   39  156  153   39   22]
 [  50   74   72   65  138 5067  111  301   54   68]
 [ 360  254  244  414  707  158 2797  461  326  279]
 [ 270  118   78  163  383  262  167 4222  225  112]
 [ 378   28  216  101  164   66  139  372 4432  104]
 [ 220   77   44  275  138   95  500  159   77 4415]]

Epoch: 10/20 
Training loss: 5.47347806918 Training accuracy: 0.671875 
Test loss: 0.947690637952 Test accuracy: 0.6936 
Test confusion matrix: 
[[3246  189  213  686   77   55  209  393  536  396]
 [ 141 4559  339  447  126   66  110  101   24   87]
 [ 172  298 4610  179   32   68  116  112  356   57]
 [ 301  995  182 3196  206   98  301  250  107  364]
 [  36   73   22  198 5053   53  277  184   51   53]
 [  62   86  120  133   56 4855  116  401   84   87]
 [ 375  296  284  594  369  118 2791  427  380  366]
 [ 337  116  114  289  238  170  143 4149  308  136]
 [ 340   37  237  137   92   42  129  251 4626  109]
 [ 279   90   52  365   32   74  365  130   82 4531]]

Epoch: 11/20 
Training loss: 4.84239383275 Training accuracy: 0.71875 
Test loss: 0.950904867556 Test accuracy: 0.69415 
Test confusion matrix: 
[[3105  182  298  534  104   72  330  472  637  266]
 [  93 4447  353  497  152   77  153  131   31   66]
 [ 107  269 4744  140   51   69  152  103  337   28]
 [ 302  885  195 3091  283  101  434  298  140  271]
 [  28   58   17  124 5209   39  289  164   48   24]
 [  38   81  107  101   84 5012  164  291   73   49]
 [ 307  254  314  503  454  115 3050  413  377  213]
 [ 243   88  133  189  290  215  235 4202  333   72]
 [ 227   23  256  102  103   51  249  246 4678   65]
 [ 346   86   76  391   86   83  555  145  121 4111]]

Epoch: 12/20 
Training loss: 8.13346141236 Training accuracy: 0.59375 
Test loss: 0.934145234444 Test accuracy: 0.699966666667 
Test confusion matrix: 
[[3425  201  167  495   79   90  169  410  597  367]
 [ 140 4710  304  321  102  100  104  101   32   86]
 [ 189  296 4487  133   40  142   95  150  408   60]
 [ 421 1063  159 2977  212  128  313  247  122  358]
 [  44   89   11  161 5173   52  257  119   52   42]
 [  62  100   73   94   60 5141  100  251   65   54]
 [ 430  341  237  505  399  161 2751  412  385  379]
 [ 336  146   68  223  311  285  132 4116  272  111]
 [ 333   42  158  109   83   62  125  311 4670  107]
 [ 335   98   41  301   33  102  333  124   85 4548]]

Epoch: 13/20 
Training loss: 4.84653030266 Training accuracy: 0.734375 
Test loss: 0.962036113797 Test accuracy: 0.690266666667 
Test confusion matrix: 
[[3565  234  193  430   59  128  172  290  382  547]
 [ 181 4760  274  324   77  103  113   47   14  107]
 [ 253  404 4548  104   18  122  107   82  258  104]
 [ 479 1127  179 2757  176  182  365  158   76  501]
 [  54  143   35  143 4890  136  351  115   52   81]
 [  61  112   87   83   29 5263   87  131   51   96]
 [ 496  360  283  400  292  199 2815  312  300  543]
 [ 479  185  116  249  244  470  165 3686  195  211]
 [ 573   49  284   98   72  104  145  256 4236  183]
 [ 272  109   34  220   21   92  270   48   38 4896]]

Epoch: 14/20 
Training loss: 6.42104645888 Training accuracy: 0.6875 
Test loss: 0.934577262653 Test accuracy: 0.69885 
Test confusion matrix: 
[[3168  231  279  623   74   52  166  418  570  419]
 [ 116 4722  322  389   87   53   96   96   29   90]
 [ 147  336 4730  147   33   43   97   94  317   56]
 [ 289 1037  209 3195  187   88  290  230  116  359]
 [  38  118   26  173 5088   41  263  159   60   34]
 [  55  129  131  102   55 4914  100  344   92   78]
 [ 373  348  310  592  375   97 2718  397  423  367]
 [ 347  140  140  255  234  150  151 4156  298  129]
 [ 307   46  282  151   77   30  105  254 4658   90]
 [ 260   97   56  345   47   64  312  115  122 4582]]

Epoch: 15/20 
Training loss: 5.83686514306 Training accuracy: 0.703125 
Test loss: 0.942486220933 Test accuracy: 0.6962 
Test confusion matrix: 
[[2989  157  217  570   92   55  239  689  589  403]
 [ 118 4365  329  493  154   70  164  194   32   81]
 [ 141  226 4622  132   48   75  142  171  377   66]
 [ 284  847  164 3080  271  101  406  391  129  327]
 [  29   54    9  108 5236   27  224  218   54   41]
 [  35   69   93  112   77 4925  131  410   69   79]
 [ 312  196  256  496  481  103 2918  543  395  300]
 [ 216   70   89  168  245  153  173 4557  225  104]
 [ 249   22  209  103  113   39  146  382 4646   91]
 [ 222   58   46  384   66   63  419  222   86 4434]]

Epoch: 16/20 
Training loss: 1.62276644126 Training accuracy: 0.671875 
Test loss: 0.958811666534 Test accuracy: 0.6911 
Test confusion matrix: 
[[3607  105  143  593   72   30  125  446  681  198]
 [ 256 4216  332  692  135   40   78  147   53   51]
 [ 259  215 4553  159   41   40   90  115  500   28]
 [ 428  751  161 3495  189   62  234  291  167  222]
 [  61   52   11  201 5175   18  163  202   91   26]
 [  88   87  107  161   90 4711  104  466  122   64]
 [ 540  216  228  749  433   67 2546  443  516  262]
 [ 401   57   80  250  245  118  102 4289  394   64]
 [ 333   18  153  118   77   27   75  242 4903   54]
 [ 631   66   50  548   58   50  321  151  154 3971]]

Epoch: 17/20 
Training loss: 3.59686667984 Training accuracy: 0.734375 
Test loss: 0.923029275563 Test accuracy: 0.7025 
Test confusion matrix: 
[[3695  188  275  366   82   57  118  422  484  313]
 [ 187 4632  453  254  116   78   77  112   28   63]
 [ 203  188 4888   93   42   70   63  121  280   52]
 [ 565 1116  235 2767  239  116  274  259   99  330]
 [  58  102   25  103 5263   34  171  146   54   44]
 [  80  102  115   78   72 5040   60  330   58   65]
 [ 561  323  339  432  464  145 2606  434  338  358]
 [ 453  122  142  170  307  165   91 4235  218   97]
 [ 436   30  290   93  101   42   82  313 4518   95]
 [ 435  134   68  253   57   68  259  143   77 4506]]

Epoch: 18/20 
Training loss: 3.67392693128 Training accuracy: 0.765625 
Test loss: 0.925066214465 Test accuracy: 0.7033 
Test confusion matrix: 
[[3324  187  266  465   86   87  233  399  523  430]
 [ 119 4657  421  297   88   78  123   94   30   93]
 [ 157  209 4869   99   31   63  122   82  307   61]
 [ 354 1038  235 2834  217  142  436  225  104  415]
 [  39  102   28  116 5121   58  293  145   57   41]
 [  50   85  118   74   52 5142  112  233   59   75]
 [ 381  312  337  422  384  148 2954  355  364  343]
 [ 320  124  151  206  252  244  185 4139  261  118]
 [ 328   36  274  106   79   44  172  266 4582  113]
 [ 262  113   59  248   51   87  421  107   76 4576]]

Epoch: 19/20 
Training loss: 4.19266095877 Training accuracy: 0.703125 
Test loss: 0.922575483181 Test accuracy: 0.703366666667 
Test confusion matrix: 
[[3353  192  252  557   62  106  170  449  439  420]
 [ 125 4522  428  434   92   96   94  106   23   80]
 [ 161  183 4875  149   25   82   76  101  279   69]
 [ 313  949  231 3171  195  141  304  247   90  359]
 [  45   73   26  177 5069   55  232  219   54   50]
 [  42   79  110   91   53 5187   97  216   47   78]
 [ 382  293  340  589  380  173 2711  412  340  380]
 [ 297  117  130  231  191  298  143 4291  187  115]
 [ 397   32  283  133   86   81  151  328 4396  113]
 [ 273   81   53  355   30   98  295  125   63 4627]]

Epoch: 20/20 
Training loss: 2.7855053572 Training accuracy: 0.71875 
Test loss: 0.979599756739 Test accuracy: 0.684016666667 
Test confusion matrix: 
[[3216  184  294  424  118   92  182  371  673  446]
 [ 150 4459  443  362  140   95  124   89   43   95]
 [ 156  232 4725   93   52   83  105   85  401   68]
 [ 381 1038  247 2767  293  140  373  232  144  385]
 [  38   83   37  113 5202   44  234  159   61   29]
 [  59  106  138   80   87 4974  101  276   90   89]
 [ 384  309  355  438  529  152 2649  359  441  384]
 [ 393  122  130  191  318  296  152 3913  349  136]
 [ 278   27  259   90  123   60  127  236 4711   89]
 [ 306  107  100  281   66  105  371  129  110 4425]]

