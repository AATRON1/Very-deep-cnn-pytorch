Model's parameters: {'optimizer': 'adam', 'input': 'input/yahoo_answers_csv', 'output': 'output/yahoo_answers_depth_17', 'alphabet': 'abcdefghijklmnopqrstuvwxyz0123456789,;.!?:\'"/\\|_@#$%^&*~`+-=<>()[]{}', 'batch_size': 128, 'dataset': 'yahoo_answers', 'depth': 17, 'max_length': 1014, 'lr': 0.001, 'shortcut': False, 'num_epochs': 20, 'gpu': True}Epoch: 1/20 
Training loss: 8.7230448937 Training accuracy: 0.59375 
Test loss: 1.18301368403 Test accuracy: 0.620883333333 
Test confusion matrix: 
[[2751  165  307  878   78   83  371  212  637  518]
 [ 132 3200  391 1672  126   71  215   37   23  133]
 [ 122  269 4350  307   78   77  337   55  313   92]
 [ 254  589  183 3484  186  100  496  118  111  479]
 [  30   41   43  465 4675   62  519   79   39   47]
 [  93  110  148  306  125 4367  323  234   95  199]
 [ 294  190  299  911  338  104 2898  200  327  439]
 [ 383  127  205  595  377  295  379 2964  413  262]
 [ 315   23  417  233  103   69  285  142 4281  132]
 [ 314   53   72  482   44   77  518   70   87 4283]]

Epoch: 2/20 
Training loss: 7.09307615168 Training accuracy: 0.609375 
Test loss: 1.05749271306 Test accuracy: 0.660316666667 
Test confusion matrix: 
[[3236  263  278  418  101  106  168  252  628  550]
 [ 179 4615  380  309  114   78   75   61   30  159]
 [ 204  373 4549  109   68   62   92  100  375   68]
 [ 472 1292  220 2479  215  107  331  164  132  588]
 [  48  200   59  196 4990   47  263  101   57   39]
 [  75  179  157  108   96 4748  119  218   98  202]
 [ 428  411  362  446  424  131 2585  295  417  501]
 [ 524  229  167  226  369  375  157 3303  396  254]
 [ 424   46  289  130  103   70  114  190 4530  104]
 [ 311  149  102  192   60   95  340   69   98 4584]]

Epoch: 3/20 
Training loss: 4.30219837585 Training accuracy: 0.765625 
Test loss: 1.03101637423 Test accuracy: 0.6709 
Test confusion matrix: 
[[3520  130  266  399   70   58  142  478  629  308]
 [ 268 4043  571  485  123   97  117  165   31  100]
 [ 195  159 4714  116   45   49   94  183  404   41]
 [ 620  813  260 2770  205  100  345  350  152  385]
 [  65   86   55  191 4872   57  274  293   68   39]
 [ 126   62  162  113   66 4646  126  467  101  131]
 [ 472  188  360  482  370  102 2757  481  440  348]
 [ 479   82  164  173  220  197  116 4120  336  113]
 [ 363   21  267   92   77   33   98  348 4619   82]
 [ 577   70   96  286   46   54  381  155  142 4193]]

Epoch: 4/20 
Training loss: 6.9820076664 Training accuracy: 0.640625 
Test loss: 1.03664852979 Test accuracy: 0.666216666667 
Test confusion matrix: 
[[3203   92  163  411   93   64  124  730  756  364]
 [ 200 3629  374  725  407   99   90  325   40  111]
 [ 171  164 4364  143  104   91   91  275  536   61]
 [ 474  628  165 2794  359  111  271  536  225  437]
 [  40   20   12  151 5194   37  161  244   98   43]
 [  59   50   79  100  115 4808   94  533   83   79]
 [ 377  142  250  531  538  129 2350  609  572  502]
 [ 269   51   82  170  254  221   97 4409  342  105]
 [ 245    9  139   56   88   43   58  463 4805   94]
 [ 390   38   48  306   65  115  232  254  135 4417]]

Epoch: 5/20 
Training loss: 6.51135135534 Training accuracy: 0.6875 
Test loss: 0.98025209168 Test accuracy: 0.68355 
Test confusion matrix: 
[[3155  279  304  465   92   95  168  396  580  466]
 [ 118 4678  467  257  118   76   92   80   24   90]
 [ 143  257 4838   71   39   71   93  102  334   52]
 [ 339 1244  298 2542  268  150  328  259  128  444]
 [  39  121   62  128 5084   60  230  177   64   35]
 [  49  135  169   93   85 4998   92  241   64   74]
 [ 385  394  397  393  418  173 2662  367  399  412]
 [ 390  192  185  182  278  307  135 3923  276  132]
 [ 364   48  281   86   92   69  100  287 4542  131]
 [ 263  144  100  215   55  113  332  116   71 4591]]

Epoch: 6/20 
Training loss: 4.26260978048 Training accuracy: 0.765625 
Test loss: 1.00083274875 Test accuracy: 0.679433333333 
Test confusion matrix: 
[[2766  390  295  693   67  130  184  581  522  372]
 [  74 4866  299  336   59  108   73  114   19   52]
 [ 112  445 4630  123   24   94   87  151  301   33]
 [ 222 1278  201 3046  163  177  274  293   95  251]
 [  26  205   37  232 4919   54  227  235   43   22]
 [  24  133   99  108   53 5085  118  279   59   42]
 [ 282  457  335  672  346  177 2690  463  354  224]
 [ 204  203  140  228  225  327  133 4222  232   86]
 [ 283   63  294  162   86   72  131  370 4464   75]
 [ 179  213  102  488   42  156  495  171   76 4078]]

Epoch: 7/20 
Training loss: 4.21981411659 Training accuracy: 0.703125 
Test loss: 0.989033076399 Test accuracy: 0.68235 
Test confusion matrix: 
[[3418  122  320  475  123   39  176  336  666  325]
 [ 207 4043  666  465  253   47   81  120   34   84]
 [ 163  111 4953   94   77   12   80   89  389   32]
 [ 456  800  331 2936  348   79  279  258  157  356]
 [  36   53   37  141 5346   20  151  126   60   30]
 [  90   72  225   94  160 4632  138  374  141   74]
 [ 419  223  409  517  603   76 2654  332  453  314]
 [ 415   89  218  187  387  132  134 3839  487  112]
 [ 326   22  294  105  114   23   99  166 4768   83]
 [ 417   69  105  316   94   53  359  107  128 4352]]

Epoch: 8/20 
Training loss: 5.4085354571 Training accuracy: 0.671875 
Test loss: 0.962873628317 Test accuracy: 0.690716666667 
Test confusion matrix: 
[[2824  226  273  456  108   97  172  592  742  510]
 [ 104 4575  429  257  176   95   99  151   27   87]
 [  88  220 4724   90   62   86   96  141  434   59]
 [ 283 1116  267 2650  314  138  311  328  154  439]
 [  16   85   38  121 5276   49  180  136   62   37]
 [  37  108  106   63   83 5066  112  275   79   71]
 [ 268  316  355  450  454  159 2668  457  477  396]
 [ 182  153  144  136  336  255  120 4199  347  128]
 [ 188   45  220   75  101   54   94  315 4804  104]
 [ 213  110   71  198   73  104  318  156  100 4657]]

Epoch: 9/20 
Training loss: 5.43365560312 Training accuracy: 0.671875 
Test loss: 0.949161274831 Test accuracy: 0.6948 
Test confusion matrix: 
[[3460  133  219  401   77   50  200  393  628  439]
 [ 250 4379  417  427   88   70  127  106   28  108]
 [ 210  206 4734  107   25   43  127  100  389   59]
 [ 470  921  215 2805  199   98  384  291  171  446]
 [  53  105   45  164 5069   28  260  158   82   36]
 [  82   91  160   75   65 4866  168  336   76   81]
 [ 464  234  324  459  361   93 2874  391  428  372]
 [ 414  113  139  138  271  159  190 4141  308  127]
 [ 352   22  220   79   72   43  122  252 4738  100]
 [ 338   69   63  216   39   62  385  109   97 4622]]

Epoch: 10/20 
Training loss: 4.75430850424 Training accuracy: 0.703125 
Test loss: 0.947264701843 Test accuracy: 0.696616666667 
Test confusion matrix: 
[[3587  199  241  434   81  102  199  372  410  375]
 [ 180 4606  311  376  119  115   92   88   17   96]
 [ 220  283 4684  113   40  101  108  113  280   58]
 [ 457 1000  203 2900  224  151  336  224   89  416]
 [  47   95   39  161 5121   66  224  173   40   34]
 [  70   83  100   72   57 5149  111  233   50   75]
 [ 481  306  318  471  381  186 2826  369  295  367]
 [ 489  153  134  184  268  306  138 4032  183  113]
 [ 517   39  290  113   84   72  158  299 4322  106]
 [ 382   98   58  223   52   98  359  106   54 4570]]

Epoch: 11/20 
Training loss: 6.36520770949 Training accuracy: 0.703125 
Test loss: 0.947188358186 Test accuracy: 0.693 
Test confusion matrix: 
[[3368  163  175  416  105  132  231  331  535  544]
 [ 179 4348  418  409  161  126  131   79   20  129]
 [ 223  192 4651  103   53  103  141   99  348   87]
 [ 440  920  209 2731  252  161  445  213  119  510]
 [  34   65   20  131 5190   59  265  137   55   44]
 [  49   65   89   69   70 5183  138  184   61   92]
 [ 443  248  275  386  424  192 2944  316  354  418]
 [ 409  123  104  176  318  347  196 3883  258  186]
 [ 416   33  193   90   90   87  155  257 4547  132]
 [ 282   69   39  200   54  105  369   84   63 4735]]

Epoch: 12/20 
Training loss: 3.69076135417 Training accuracy: 0.703125 
Test loss: 0.942089268486 Test accuracy: 0.6981 
Test confusion matrix: 
[[3537  175  146  376   57  150  185  428  513  433]
 [ 193 4631  309  292   66  126  108  126   26  123]
 [ 236  288 4457  108   18  113  136  133  412   99]
 [ 476 1072  157 2699  160  189  346  278  120  503]
 [  58  146   18  142 4928   90  278  225   58   57]
 [  52   78   66   50   40 5255  116  210   62   71]
 [ 464  310  223  401  309  215 2760  405  374  539]
 [ 368  118   88  131  197  351  148 4207  261  131]
 [ 439   35  142   91   66   68  125  283 4651  100]
 [ 342   94   35  195   27  124  238  108   76 4761]]

Epoch: 13/20 
Training loss: 6.41549672885 Training accuracy: 0.703125 
Test loss: 0.93553809846 Test accuracy: 0.697716666667 
Test confusion matrix: 
[[3697  149  136  421   82   81  186  353  580  315]
 [ 226 4404  317  496  122   92  123  114   37   69]
 [ 283  229 4459  128   32  105  131  111  460   62]
 [ 559  894  165 2938  237  117  368  241  134  347]
 [  54   69   21  149 5186   45  238  143   55   40]
 [  72   69   79  107   74 5059  115  278   77   70]
 [ 554  250  229  480  373  136 2861  350  409  358]
 [ 479  105   91  204  289  242  136 4043  304  107]
 [ 424   27  145   96   95   56  110  225 4736   86]
 [ 443   76   38  304   50   74  326  114   95 4480]]

Epoch: 14/20 
Training loss: 3.66803279397 Training accuracy: 0.765625 
Test loss: 0.938508640007 Test accuracy: 0.696866666667 
Test confusion matrix: 
[[3367  200  207  343   93   81  178  529  544  458]
 [ 175 4594  372  264  122   62  129  157   26   99]
 [ 175  270 4710   75   30   53  104  156  365   62]
 [ 433 1058  227 2516  245  119  417  351  142  492]
 [  38   92   33   96 5191   38  226  187   60   39]
 [  54  116  125   54   62 4952  136  348   67   86]
 [ 423  289  344  304  413  122 2738  447  407  513]
 [ 323  116  118  122  254  159  173 4380  218  137]
 [ 337   31  230   63   80   44  129  414 4562  110]
 [ 319   92   57  153   51   75  242  120   89 4802]]

Epoch: 15/20 
Training loss: 6.31473736116 Training accuracy: 0.71875 
Test loss: 0.933329935242 Test accuracy: 0.70025 
Test confusion matrix: 
[[3375  170  210  517   82   91  211  411  546  387]
 [ 177 4464  361  407  149   98   97  145   28   74]
 [ 184  237 4671  145   45   78  101  131  359   49]
 [ 369  957  193 3064  243  131  295  291  120  337]
 [  32   65   25  157 5161   48  207  221   56   28]
 [  45   85   96   97   62 5098  107  275   56   79]
 [ 439  272  280  541  401  154 2792  406  391  324]
 [ 339  102  113  212  219  214  151 4270  251  129]
 [ 365   27  204  119   88   62  128  291 4630   86]
 [ 307   95   59  345   54   92  340  115  103 4490]]

Epoch: 16/20 
Training loss: 4.22517861915 Training accuracy: 0.75 
Test loss: 0.938322124337 Test accuracy: 0.6979 
Test confusion matrix: 
[[3287  152  269  442   93   66  185  348  778  380]
 [ 185 4409  481  341  166   74  118   95   39   92]
 [ 151  156 4818   77   52   52   91   85  464   54]
 [ 403  974  246 2735  299  103  368  238  190  444]
 [  33   70   25  104 5248   35  205  152   89   39]
 [  54   83  133   85   77 5001  139  235   91  102]
 [ 397  254  344  383  439  117 2847  323  532  364]
 [ 358  118  144  169  291  213  162 3989  418  138]
 [ 270   22  205   75   85   36  100  209 4915   83]
 [ 324   74   76  212   66   57  341   90  135 4625]]

Epoch: 17/20 
Training loss: 3.63995221186 Training accuracy: 0.75 
Test loss: 0.947462917495 Test accuracy: 0.69385 
Test confusion matrix: 
[[3988  129  108  450   90   58  180  313  399  285]
 [ 274 4519  277  406  125   69  113  127   16   74]
 [ 372  286 4425  145   48   91  155  140  284   54]
 [ 610  978  147 2951  264  100  353  226   80  291]
 [  53   83   13  136 5215   27  221  183   40   29]
 [ 110   79   70  125   75 4968  125  299   63   86]
 [ 640  250  215  526  446  108 2841  358  289  327]
 [ 644  100   63  214  272  159  142 4105  178  123]
 [ 709   31  195  119   97   47  155  268 4282   97]
 [ 551   77   37  395   63   57  344   91   48 4337]]

Epoch: 18/20 
Training loss: 6.79403820357 Training accuracy: 0.703125 
Test loss: 0.945876310664 Test accuracy: 0.69365 
Test confusion matrix: 
[[3655  202  130  524   65  113  279  252  408  372]
 [ 206 4597  230  468  102  128  128   57   15   69]
 [ 279  380 4345  151   35  137  194   95  320   64]
 [ 435  998  132 3028  212  135  432  182   75  371]
 [  47   83   17  159 5095   47  368  115   37   32]
 [  71   76   60  128   56 5189  146  164   51   59]
 [ 523  282  205  488  313  173 3108  281  306  321]
 [ 564  153   87  235  296  331  209 3785  205  135]
 [ 660   37  184  120   81   69  195  208 4333  113]
 [ 372  101   32  321   33  102  429   69   57 4484]]

Epoch: 19/20 
Training loss: 4.08681683856 Training accuracy: 0.796875 
Test loss: 0.946958922921 Test accuracy: 0.695733333333 
Test confusion matrix: 
[[2873  262  381  476   70  149  222  369  501  697]
 [  92 4714  404  313   84  111   89   65   18  110]
 [  90  282 4978   93   22   76   93   88  220   58]
 [ 268 1150  252 2721  188  190  374  210   90  557]
 [  25  129   46  137 5078   75  254  158   41   57]
 [  30  100  113   56   46 5281   91  157   46   80]
 [ 276  350  425  414  340  205 2881  336  311  462]
 [ 264  201  185  167  263  374  160 3984  206  196]
 [ 253   51  481  103   85  100  147  277 4321  182]
 [ 135  125   89  166   35  109  311   74   43 4913]]

Epoch: 20/20 
Training loss: 4.76123511238 Training accuracy: 0.75 
Test loss: 0.93326011163 Test accuracy: 0.697933333333 
Test confusion matrix: 
[[3419  137  334  391   69   50  161  332  641  466]
 [ 202 4277  656  350   99   71  107  101   31  106]
 [ 169  117 5004   87   19   36   81   78  361   48]
 [ 454  926  312 2846  189   94  328  244  140  467]
 [  52   76   50  145 5063   42  269  187   69   47]
 [  86   68  172   99   46 4903  111  308  105  102]
 [ 475  243  436  433  338   92 2764  344  430  445]
 [ 471  101  172  184  230  149  136 4082  352  123]
 [ 344   15  281   85   83   29   87  206 4774   96]
 [ 328   66   91  218   34   52  270   96  101 4744]]

