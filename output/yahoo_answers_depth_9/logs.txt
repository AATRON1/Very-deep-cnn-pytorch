Model's parameters: {'optimizer': 'adam', 'input': 'input/yahoo_answers_csv', 'output': 'output/yahoo_answers_depth_9', 'alphabet': 'abcdefghijklmnopqrstuvwxyz0123456789,;.!?:\'"/\\|_@#$%^&*~`+-=<>()[]{}', 'batch_size': 128, 'dataset': 'yahoo_answers', 'depth': 9, 'max_length': 1014, 'lr': 0.001, 'shortcut': False, 'num_epochs': 20, 'gpu': True}Epoch: 1/20 
Training loss: 6.05222021483 Training accuracy: 0.671875 
Test loss: 1.13439512987 Test accuracy: 0.63475 
Test confusion matrix: 
[[3297  329  435  446  108   62  152  362  547  262]
 [ 217 4421  499  358  172   66   61  104   26   76]
 [ 185  347 4632  141   80   39   92  113  337   34]
 [ 534 1258  317 2576  295   90  228  281  120  301]
 [  52  165   68  186 4987   37  195  219   61   30]
 [ 121  279  266  136  147 4252  113  485  103   98]
 [ 491  437  497  613  594  112 2200  363  380  313]
 [ 536  211  257  240  313  198  150 3666  325  104]
 [ 483   42  407  148   98   38  101  277 4335   71]
 [ 658  283  192  345  106   80  371  148   98 3719]]

Epoch: 2/20 
Training loss: 6.58047563107 Training accuracy: 0.65625 
Test loss: 1.0940298664 Test accuracy: 0.650016666667 
Test confusion matrix: 
[[2690   93  138  450  266   93  250  630  855  535]
 [ 175 3612  337  497  561  164  191  251   64  148]
 [ 143  171 4034  115  264  117  263  242  549  102]
 [ 286  651  138 2592  620  139  440  428  208  498]
 [  12   22   10   78 5358   29  183  224   49   35]
 [  34   42   66   94  249 4636  122  543  111  103]
 [ 244  143  171  370  816  154 2739  509  480  374]
 [ 195   44   62  145  428  248  172 4137  424  145]
 [ 164   11  132   83  205   57  146  328 4772  102]
 [ 221   40   35  205  185  110  433  198  142 4431]]

Epoch: 3/20 
Training loss: 8.11156828329 Training accuracy: 0.640625 
Test loss: 1.00927387326 Test accuracy: 0.674916666667 
Test confusion matrix: 
[[3003  285  346  409  106   93   92  554  579  533]
 [ 119 4596  470  266  111   90   55  125   32  136]
 [ 121  250 4730  102   48   61   62  173  373   80]
 [ 376 1159  275 2598  252  119  210  341  128  542]
 [  34  155   58  131 5162   40  136  164   56   64]
 [  51  149  167   93   91 4756   71  418   84  120]
 [ 329  383  430  505  543  157 2249  469  424  511]
 [ 286  151  193  171  331  244   98 4068  297  161]
 [ 290   42  291  105  107   57   49  325 4632  102]
 [ 212  128   85  228   68   93  202  165  118 4701]]

Epoch: 4/20 
Training loss: 7.53669680888 Training accuracy: 0.625 
Test loss: 0.987407285477 Test accuracy: 0.681783333333 
Test confusion matrix: 
[[2990  289  286  507  103  186  222  434  528  455]
 [ 122 4652  345  322  127  132  104   85   22   89]
 [ 141  337 4621  128   45   84  126  128  340   50]
 [ 321 1135  185 2840  239  202  342  240  100  396]
 [  32  114   30  123 5161   64  211  166   65   34]
 [  37  119  124   95   64 5080  106  261   58   56]
 [ 333  372  342  473  438  230 2770  373  370  299]
 [ 285  190  168  203  297  395  194 3910  246  112]
 [ 293   53  276  134   99  118  139  288 4500  100]
 [ 220  157   88  278   70  173  428  123   80 4383]]

Epoch: 5/20 
Training loss: 5.31166863711 Training accuracy: 0.78125 
Test loss: 0.978877004402 Test accuracy: 0.683433333333 
Test confusion matrix: 
[[3755  158  258  262   72   50  219  401  445  380]
 [ 314 4433  367  336  122   73  122   96   22  115]
 [ 255  245 4649   92   36   57  154  143  297   72]
 [ 732  937  219 2567  190  102  414  276   97  466]
 [  61   98   34  127 5015   26  293  235   50   61]
 [ 113  135  151   95   68 4692  139  429   58  120]
 [ 549  279  325  381  370  100 2872  374  326  424]
 [ 537  109  155  129  224  160  209 4122  209  146]
 [ 534   33  294   74   79   50  174  296 4351  115]
 [ 458   83   62  206   35   69  337  134   66 4550]]

Epoch: 6/20 
Training loss: 6.45263792574 Training accuracy: 0.6875 
Test loss: 0.97078464719 Test accuracy: 0.686183333333 
Test confusion matrix: 
[[3272  206  271  655   84   65  173  398  515  361]
 [ 161 4347  338  701  127   64   85   76   21   80]
 [ 155  276 4680  199   42   61   97  128  310   52]
 [ 339  830  191 3419  196   83  278  225  105  334]
 [  32   88   29  211 5175   35  189  154   49   38]
 [  72  146  155  206   80 4803  102  291   61   84]
 [ 386  285  330  665  443  130 2744  375  351  291]
 [ 370  140  133  388  303  240  149 3904  242  131]
 [ 332   43  311  186   94   60  113  285 4512   64]
 [ 325  107   65  449   63   92  369  109  106 4315]]

Epoch: 7/20 
Training loss: 3.60971310227 Training accuracy: 0.765625 
Test loss: 0.968145132479 Test accuracy: 0.686416666667 
Test confusion matrix: 
[[3184  163  281  354  102   51  256  579  444  586]
 [ 163 4211  494  413  161   84  155  138   16  165]
 [ 169  158 4798  104   48   63  142  156  264   98]
 [ 429  833  243 2707  255   88  461  342   83  559]
 [  30   53   44  112 5202   30  256  183   38   52]
 [  58   73  149  103   84 4743  149  459   50  132]
 [ 362  222  331  361  439  126 2928  440  306  485]
 [ 301   77  149  158  296  165  236 4270  183  165]
 [ 354   31  310   87  109   53  186  395 4325  150]
 [ 202   61   75  190   60   65  338  144   48 4817]]

Epoch: 8/20 
Training loss: 3.84290890826 Training accuracy: 0.671875 
Test loss: 0.952845442623 Test accuracy: 0.692283333333 
Test confusion matrix: 
[[3385  155  203  466  109  100  206  407  469  500]
 [ 202 4275  346  522  185  118  101   99   18  134]
 [ 228  226 4567  134   64  119  100  160  307   95]
 [ 426  825  178 3001  265  128  327  268   95  487]
 [  33   46   25  125 5227   42  231  171   45   55]
 [  62   83   91  117   86 5033   99  285   53   91]
 [ 417  237  284  495  449  154 2812  401  320  431]
 [ 393   95  102  236  298  269  148 4079  199  181]
 [ 419   34  248  117  104   77  127  310 4446  118]
 [ 253   72   51  261   60   89  325  106   71 4712]]

Epoch: 9/20 
Training loss: 4.87147658505 Training accuracy: 0.625 
Test loss: 0.958643862211 Test accuracy: 0.691883333333 
Test confusion matrix: 
[[3336  135  158  674   90  104  205  530  504  264]
 [ 191 4226  391  611  121  126  106  136   26   66]
 [ 226  196 4503  191   41  119  127  199  360   38]
 [ 373  789  152 3379  220  110  314  279  100  284]
 [  33   54   17  182 5128   50  219  229   54   34]
 [  54   69   90  143   69 5063   98  303   59   52]
 [ 419  214  242  632  441  170 2831  451  352  248]
 [ 340   70   66  283  227  275  165 4289  198   87]
 [ 386   25  174  154   97   68  123  357 4541   75]
 [ 353   89   58  457   49  108  428  162   79 4217]]

Epoch: 10/20 
Training loss: 5.36643460992 Training accuracy: 0.65625 
Test loss: 0.95556259223 Test accuracy: 0.69175 
Test confusion matrix: 
[[2920  215  372  586   88   91  295  429  566  438]
 [ 113 4379  515  406  124  114  129   91   26  103]
 [ 102  160 4943  139   40   57  131  110  265   53]
 [ 280  938  257 3088  207  112  392  240   97  389]
 [  16   71   46  161 5130   41  311  141   48   35]
 [  44   66  187  108   73 4948  162  269   62   81]
 [ 263  244  395  553  376  153 3025  355  341  295]
 [ 242  108  177  262  326  242  216 4021  264  142]
 [ 228   26  372  145   96   62  175  255 4547   94]
 [ 210  104  100  303   54   90  459   96   80 4504]]

Epoch: 11/20 
Training loss: 7.41794598075 Training accuracy: 0.6875 
Test loss: 0.943948541177 Test accuracy: 0.69495 
Test confusion matrix: 
[[3313  240  310  447   74  119  133  356  633  375]
 [ 138 4606  433  313  106  126   90   77   32   79]
 [ 132  231 4849  109   35   87   69  105  333   50]
 [ 384 1083  261 2925  209  167  252  209  134  376]
 [  34  116   38  140 5156   63  191  158   62   42]
 [  48   82  150   94   54 5157   90  196   68   61]
 [ 386  323  364  547  416  193 2624  331  408  408]
 [ 370  142  172  231  275  386  130 3839  313  142]
 [ 294   34  310  118   92   79   91  217 4665  100]
 [ 280  140   99  277   39  138  273   94   97 4563]]

Epoch: 12/20 
Training loss: -1 Training accuracy: 0.6875 
Test loss: 0.944628394396 Test accuracy: 0.69565 
Test confusion matrix: 
[[3371  199  192  379   97  104  153  496  536  473]
 [ 156 4541  372  317  124  137   84  123   27  119]
 [ 219  233 4613  109   43  101  103  164  341   74]
 [ 457 1036  183 2746  216  163  312  339  118  430]
 [  43   75   23  110 5180   64  179  223   52   51]
 [  67   87  106   74   49 5100   82  299   55   81]
 [ 438  296  266  405  411  202 2650  486  360  486]
 [ 392  107   93  146  234  296  140 4250  214  128]
 [ 380   43  203   81   93   80  104  341 4551  124]
 [ 271   97   49  235   53   90  266  140   62 4737]]

Epoch: 13/20 
Training loss: 5.77609579911 Training accuracy: 0.640625 
Test loss: 0.947987644573 Test accuracy: 0.695083333333 
Test confusion matrix: 
[[3491  177  213  343   93   84  210  482  584  323]
 [ 211 4488  379  310  158   82  110  142   32   88]
 [ 184  227 4655   92   58   84  120  162  369   49]
 [ 501  972  203 2708  250  120  364  334  149  399]
 [  41   75   19  111 5246   33  189  176   66   44]
 [  69   94  112   74   75 4938  135  357   78   68]
 [ 423  257  285  420  459  146 2800  438  434  338]
 [ 371   98   88  152  301  199  173 4247  257  114]
 [ 346   36  207   90   85   60  123  314 4663   76]
 [ 383   89   61  217   62   73  373  161  112 4469]]

Epoch: 14/20 
Training loss: 2.78332448786 Training accuracy: 0.703125 
Test loss: 0.95256944711 Test accuracy: 0.69535 
Test confusion matrix: 
[[3497  221  148  416   94  102  216  286  529  491]
 [ 175 4570  306  405  123   90  130   54   23  124]
 [ 239  274 4414  148   48  128  166  103  387   93]
 [ 450  983  126 2996  219  131  341  186  126  442]
 [  42   73   17  148 5154   53  280  128   55   50]
 [  59  122   89   91   70 5074  138  193   68   96]
 [ 453  288  220  478  415  161 2937  283  376  389]
 [ 481  143   86  230  304  309  226 3775  241  205]
 [ 436   55  159  106  100   64  160  212 4600  108]
 [ 251   95   31  256   60   95  356   63   89 4704]]

Epoch: 15/20 
Training loss: 2.02733341564 Training accuracy: 0.859375 
Test loss: 0.964768097103 Test accuracy: 0.6916 
Test confusion matrix: 
[[3661  159  200  294   81  164  163  454  460  364]
 [ 227 4423  423  279  115  188  113  115   25   92]
 [ 255  189 4646   86   39  144  101  155  329   56]
 [ 623  981  207 2536  228  218  341  303  125  438]
 [  54   85   35  103 5092   71  231  224   47   58]
 [  58   53  102   61   46 5202  103  267   44   64]
 [ 533  247  302  357  399  232 2717  424  348  441]
 [ 480   99  101  125  217  322  150 4179  209  118]
 [ 488   27  247   70   80  113  124  283 4480   88]
 [ 413   90   60  195   38  155  285  133   71 4560]]

Epoch: 16/20 
Training loss: 1.48242557468 Training accuracy: 0.78125 
Test loss: 0.962328757833 Test accuracy: 0.692366666667 
Test confusion matrix: 
[[3411  153  224  357   61  203  214  327  606  444]
 [ 188 4363  419  409   66  211  120   87   26  111]
 [ 171  185 4672  121   19  171  124  101  368   68]
 [ 501  933  205 2781  149  231  390  221  137  452]
 [  44  100   37  156 4861  103  325  225  100   49]
 [  55   50   92   65   33 5297   94  186   64   64]
 [ 404  238  295  417  275  292 2890  353  419  417]
 [ 416   94  112  174  166  479  196 3896  330  137]
 [ 322   31  254   76   53  124  131  194 4716   99]
 [ 280   87   56  227   27  174  318   81   95 4655]]

Epoch: 17/20 
Training loss: 6.37755805552 Training accuracy: 0.671875 
Test loss: 0.957647006512 Test accuracy: 0.692616666667 
Test confusion matrix: 
[[3480  125  236  381   65  102  161  513  601  336]
 [ 221 4245  467  467   71  147   88  150   34  110]
 [ 195  165 4711  113   19  109   89  150  387   62]
 [ 519  824  234 2889  161  165  312  328  148  420]
 [  47   93   41  147 4929   84  225  288   92   54]
 [  73   53  120   72   34 5107   81  307   70   83]
 [ 447  233  312  466  336  219 2611  466  468  442]
 [ 367   79  112  169  171  268  120 4303  283  128]
 [ 324   23  232   84   59   79   91  329 4704   75]
 [ 380   65   75  242   31  106  246  150  127 4578]]

Epoch: 18/20 
Training loss: 4.8149275051 Training accuracy: 0.640625 
Test loss: 0.968661938731 Test accuracy: 0.690483333333 
Test confusion matrix: 
[[3605  139  145  490   72   43  187  314  606  399]
 [ 266 4270  333  624  101   54  104   62   44  142]
 [ 301  208 4479  179   28   42  140   86  449   88]
 [ 511  828  132 3223  169   67  295  182  167  426]
 [  59   82   27  212 5034   35  242  160   78   71]
 [ 126  102  126  175   57 4737  138  277  105  157]
 [ 512  234  236  616  358  105 2720  292  462  465]
 [ 492   95   93  270  236  155  225 3900  361  173]
 [ 397   25  158  100   80   31  136  182 4794   97]
 [ 374   69   37  341   30   50  238   72  122 4667]]

Epoch: 19/20 
Training loss: 5.21241153055 Training accuracy: 0.75 
Test loss: 0.974387017183 Test accuracy: 0.690033333333 
Test confusion matrix: 
[[3178  132  247  678  109   78  268  439  551  320]
 [ 170 3949  435  797  143  118  155  127   29   77]
 [ 149  157 4777  165   39   82  140  139  315   37]
 [ 314  684  207 3455  215  128  341  261  120  275]
 [  27   34   34  196 5140   48  234  196   61   30]
 [  49   49  119  155   67 4965  154  304   73   65]
 [ 332  168  326  644  415  149 2938  377  381  270]
 [ 292   60  128  294  233  218  231 4194  257   93]
 [ 334   20  284  157   85   53  164  241 4588   74]
 [ 318   61   83  494   68   95  446  120   97 4218]]

Epoch: 20/20 
Training loss: 8.59230326413 Training accuracy: 0.546875 
Test loss: 0.975602367559 Test accuracy: 0.6914 
Test confusion matrix: 
[[3464  161  268  399   71   51  211  338  564  473]
 [ 226 4472  390  436  103   54  103   71   27  118]
 [ 207  224 4773  124   24   49  125   92  323   59]
 [ 497  945  224 2969  187   73  349  201  124  431]
 [  47   87   38  166 5116   35  277  117   60   57]
 [  96  117  172  156   65 4715  147  327   76  129]
 [ 449  273  324  523  364  100 2790  307  385  485]
 [ 450  108  140  244  289  177  233 3892  299  168]
 [ 375   33  294  105   81   41  164  201 4589  117]
 [ 303   84   76  249   38   54  312   87   93 4704]]

